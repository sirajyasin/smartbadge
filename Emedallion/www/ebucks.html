<html>
    <head>
        <meta name="msapplication-tap-highlight" content="no">
	<meta http-equiv="refresh" content="300"/>
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/all.css">
        <title>E-Madallion</title>
    </head>
    <body>
	<div class="page_header">
            <div class="head col-lg-12 btn btn-primary"><a class="menu" href="index.html"><i class="fa fa-fw fa-home"></i></a>   E-Medallion</div>
	</div>
        <div class="container">
	  <div class="smenu col-lg-12 btn btn-success"><a class="menu" href="#"><i class="fa fa-fw fa-user"></i>  e-Bucks</a></div>
	  <div class="alert alert-success">Your Gift Card Balance:  <span id='gift_amnt' class="badge badge-success">$65</span> </div>
	  <div id='redeem_box'>
            <form id='apply_code'>
             <div class="row">
	       <div class="alert alert-info col-lg-12">Redeem Your E-Bucks Gift Coupon Here</div>
	 
               <div class="col claim_code_div">
                 <input id='claim_code' type="text" class="form-control" placeholder="Claim Code">
               </div>
               <div class="col claim_code_div">
		       <button class="btn btn-warning">Apply Code</button>
               </div>
	       <div class="alert alert-info col-lg-12">Or Scan the QR code Here</div>
	       <a id='scan' class="btn btn-info col-lg-12">Start Scan</a>
             </div>
            </form>
          </div>
	  <div class="smenu col-lg-12 btn btn-success"><a class="menu" href="index.html"><i class="fa fa-fw fa-home"></i>  Home</a></div>
        </div>
        <!--<div class="page_footer">
          <footer class="footer site_color1">
            <div class="container">
              <span class="text-muted">Ericsson Proprietary (Restricted access).</span>
            </div>
          </footer>
	</div>-->

        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/qrcode.min.js"></script>
        <script>
	   $('#apply_code').submit(function( event ) {
               $('#gift_amnt').html('$115')
               event.preventDefault();
           })
           document.querySelector("#scan").addEventListener("touchend", function() {
               window.QRScanner.prepare(onDone);

           });

           function onDone(err, status){
              if (err) {
                  // here we can handle errors and clean up any loose ends.
                  console.error(err);
              }
              if (status.authorized) {
          
                  // window.QRScanner.show();
                  window.QRScanner.show(function(status){
                      window.QRScanner.scan(displayContents);
                  });
                  // window.QRScanner.scan(displayContents);
              } else if (status.denied) {
                  // The video preview will remain black, and scanning is disabled. We can
                  // try to ask the user to change their mind, but we'll have to send them
                  // to their device settings with `QRScanner.openSettings()`.
              } else {
                  // we didn't get permission, but we didn't get permanently denied. (On
                  // Android, a denial isn't permanent unless the user checks the "Don't
                  // ask again" box.) We can ask again at the next relevant opportunity.
              }
           }

           function displayContents(err, text){
              if(err){
                  // an error occurred, or the scan was canceled (error code `6`)
              } else {
                  // The scan completed, display the contents of the QR code:
                  // alert(text);
                  $('claim_code').setAttribute('value', text);
                  window.QRScanner.hide(function(status){
                      document.getElementsByTagName("BODY")[0].setAttribute('style','background-color: transparent');
                  });
              }
           }
	</script>
    </body>
</html>
